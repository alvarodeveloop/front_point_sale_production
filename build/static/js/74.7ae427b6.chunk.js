(this["webpackJsonpappwork-react-starter"]=this["webpackJsonpappwork-react-starter"]||[]).push([[74],{830:function(e,a,t){"use strict";t.r(a);var n=t(20),c=t(16),o=t(1),l=t.n(o),r=t(305),i=t(615),s=t(614),u=t(604),d=t(205),m=t(618),b=t(9),f=t.n(b),g=t(10),p=t(8),_=t(18),E=t(32),v=t(620),O=t(619),j=t(55),y=t(165),h=(t(311),t(29)),C=t(655),N=t(621),G=t(656),k=t(83),S=t(678),w=null;a.default=Object(h.b)((function(e){return{id_branch_office:e.enterpriseSucursal.id_branch_office,id_enterprise:e.enterpriseSucursal.id_enterprise,configGeneral:e.configs.config,configStore:e.configs.configStore}}),{})((function(e){var a=Object(o.useState)(!0),t=Object(c.a)(a,2),b=t[0],h=t[1],B=Object(o.useState)([]),H=Object(c.a)(B,2),z=H[0],D=H[1],T=Object(o.useState)({}),A=Object(c.a)(T,2),M=A[0],P=A[1],Y=Object(o.useState)(!1),x=Object(c.a)(Y,2),F=x[0],q=x[1],I=Object(o.useState)(!1),R=Object(c.a)(I,2),J=R[0],U=R[1],V=Object(o.useState)({}),K=Object(c.a)(V,2),L=K[0],Q=K[1],W=Object(o.useState)(1),X=Object(c.a)(W,2),Z=X[0],$=X[1],ee=Object(o.useState)({date_desde:"",date_hasta:"",type:1}),ae=Object(c.a)(ee,2),te=ae[0],ne=ae[1],ce=Object(o.useState)({}),oe=Object(c.a)(ce,2),le=oe[0],re=oe[1],ie=Object(o.useState)(!1),se=Object(c.a)(ie,2),ue=se[0],de=se[1];Object(o.useMemo)((function(){w=[{Header:"Referencia",accessor:"ref",Cell:function(e){var a=e.cell.row.original;return l.a.createElement(v.a,{placement:"bottom",overlay:l.a.createElement(O.a,{id:"tooltip-disabled2"},"Hacer click para acceder a las acciones de la gu\xeda")},l.a.createElement(r.a,{variant:"link",block:!0,type:"button",size:"sm",onClick:function(){return me(a)}},a.ref))}},{Header:"Ref Cotizaci\xf3n",accessor:"ref_cotizacion"},{Header:"Rut Cliente",accessor:"rut_client"},{Header:"Raz\xf3n Social",accessor:"business_name_client",Cell:function(e){var a=e.cell.row.original;return l.a.createElement(v.a,{placement:"right",overlay:l.a.createElement(O.a,{id:"tooltip-disabled2"},l.a.createElement("ul",{className:"list-group"},l.a.createElement("li",{className:"list-group-item"},l.a.createElement("b",null,"Contacto")," ",a.name_contact?a.name_contact:"No posee"),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("b",null,"Ciudad")," ",a.city_client?a.city_client:"No posee"),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("b",null,"Comuna")," ",a.comuna_client?a.comuna_client:"No posee"),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("b",null,"Comuna")," ",a.address_client?a.address_client:"No posee"),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("b",null,"Comentario: ")," ",a.comment)))},l.a.createElement(r.a,{variant:"link",size:"sm",block:!0,type:"button"},a.business_name_client))}},{Header:"Fecha-Emisi\xf3n",accessor:function(e){return[y(e.date_issue_invoice).tz("America/Santiago").format("DD-MM-YYYY")]}},{Header:"Status",accessor:function(e){return 1==e.status?l.a.createElement(i.a,{variant:"secondary",className:"font-badge"},"Pendiente"):2==e.status?l.a.createElement(i.a,{variant:"secondary",className:"font-badge"},"Vencida"):3==e.status?l.a.createElement(i.a,{variant:"secondary",className:"font-badge"},"Pagada"):l.a.createElement(i.a,{variant:"secondary",className:"font-badge"},"Anulada")}},{Header:"Total Productos",accessor:"total_product",Cell:function(a){var t=a.cell.row.original;return l.a.createElement(v.a,{placement:"left",overlay:l.a.createElement(O.a,{id:"tooltip-total_pagar"+t.id},l.a.createElement("ul",{className:"list-group"},t.products.map((function(a,n){return l.a.createElement("li",{className:"list-group-item",key:n},l.a.createElement("b",null,"Producto"),": ",a.name_product,l.a.createElement("br",null),l.a.createElement("b",null,"Precio")," : ",e.configGeneral?e.configGeneral.simbolo_moneda:""," ",Object(_.g)(e.configGeneral,t.total_with_iva?a.price:a.total),l.a.createElement("br",null),l.a.createElement("b",null,"Cantidad"),": ",a.quantity)}))))},l.a.createElement(i.a,{variant:"info",className:"font-badge",style:{backgroundColor:"rgb(198, 196, 54)",color:"white"}},e.configGeneral.simbolo_moneda+Object(_.g)(e.configGeneral,t.total_product)))}},{Header:"Total gastos",accessor:"total_gastos",Cell:function(a){return l.a.createElement(i.a,{variant:"info",className:"font-badge",style:{backgroundColor:"rgb(198, 196, 54)",color:"white"}},e.configGeneral.simbolo_moneda,Object(_.g)(e.configGeneral,a.cell.row.original.total_gastos))}},{Header:"Total Iva",accessor:"total_iva",Cell:function(a){return l.a.createElement(i.a,{variant:"info",className:"font-badge",style:{backgroundColor:"rgb(198, 196, 54)",color:"white"}},e.configGeneral.simbolo_moneda,Object(_.g)(e.configGeneral,a.cell.row.original.total_iva))}},{Header:"Total Balance",accessor:"total_balance",Cell:function(a){return l.a.createElement(i.a,{variant:"info",className:"font-badge",style:{backgroundColor:"rgb(198, 196, 54)",color:"white"}},e.configGeneral.simbolo_moneda,Object(_.g)(e.configGeneral,a.cell.row.original.total_balance))}},{Header:"Abonado",accessor:"total_bond",Cell:function(a){return l.a.createElement(i.a,{variant:"danger",className:"font-badge"},e.configGeneral?e.configGeneral.simbolo_moneda:"",Object(_.g)(e.configGeneral,a.cell.row.original.total_bond))}},{Header:"Saldo Deudor",accessor:"debit_balance",Cell:function(a){return l.a.createElement(i.a,{variant:"danger",className:"font-badge"},e.configGeneral?e.configGeneral.simbolo_moneda:"",Object(_.g)(e.configGeneral,a.cell.row.original.debit_balance))}},{Header:"Productos Pagados",Cell:function(e){var a=e.cell.row.original;return a.is_products_paid?l.a.createElement(i.a,{variant:"success",className:"font-badge"},a.total_quantity_products_paid,"/",a.total_quantity_products):l.a.createElement(i.a,{variant:"danger",className:"font-badge"},a.total_quantity_products_paid,"/",a.total_quantity_products)}},{Header:"Acciones",Cell:function(e){var a=e.cell.row.original;return l.a.createElement(r.a,{variant:"primary",block:!0,type:"button",size:"sm",onClick:function(){return me(a)}},"Acciones")}}]}),[]),Object(o.useEffect)((function(){return j.a.toggleCollapsed(),function(){w=null,j.a.toggleCollapsed()}}),[]),Object(o.useEffect)((function(){fe()}),[e.id_branch_office]),Object(o.useEffect)((function(){J&&be()}),[J]);var me=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!ue&&e&&re(e),de(!ue)},be=function(){setTimeout((function(){U(!1)}),2e3)},fe=function(){var a=Object.assign({},te),t=[f.a.get(g.b+"guide"),f.a.post(g.b+"invoice_stadistics",a)];Promise.all(t).then((function(e){D(e[0].data),Q(Object(n.a)(Object(n.a)({},L),{},{statusesBonds:e[1].data.statusesBonds,statuses:e[1].data.statuses,bondsByMonth:e[1].data.bondsByMonth,invoiceByYear:e[1].data.invoiceByYear,totalByStatus:e[1].data.totalByStatus})),setTimeout((function(){U(!0)}),1e3),h(!1)})).catch((function(a){h(!1),e.tokenExpired(a)}))},ge=function(){q(!F)},pe=function(a){p.b.info("Anulando factura, esto podr\xeda tardar unos segundos... espere por favor"),h(!0),f.a.put(g.b+"guide_status/"+a).then((function(e){p.b.success("Gu\xeda anulada con \xe9xito"),re(Object(n.a)(Object(n.a)({},le),{},{status:4})),fe()})).catch((function(a){h(!1),e.tokenExpired(a)}))};return l.a.createElement(s.a,{fluid:!0},l.a.createElement(u.a,null,l.a.createElement(d.a,{sm:6,md:6,lg:6,className:"text-center"},l.a.createElement("h4",{className:"title_principal"},"Tabla de Gu\xedas"),l.a.createElement(r.a,{block:!0,variant:"success",onClick:function(){e.history.replace("/guide/guide_create")},size:"sm"},"Nueva Gu\xeda ",l.a.createElement(E.A,null))),l.a.createElement(d.a,{sm:6,md:6,lg:6,className:"text-center title_principal"},l.a.createElement("h4",null,"Total Gu\xedas Realizadas"),l.a.createElement(i.a,{variant:"danger"},z.length))),l.a.createElement("hr",null),b?l.a.createElement(k.a,null):l.a.createElement(l.a.Fragment,null,l.a.createElement(G.a,{setDataForm:ne,dataForm:te,redraw:J,statusCotization:L,handleDisplayFilter:function(e){3==e&&ne({date_desde:"",date_hasta:""}),$(e)},handleStadistics:function(){var a=Object.assign({},te);$(3),f.a.post(g.b+"guide_stadistics",a).then((function(e){Q(Object(n.a)(Object(n.a)({},L),{},{statusesBonds:e.data.statusesBonds,statuses:e.data.statuses,bondsByMonth:e.data.bondsByMonth,invoiceByYear:e.data.invoiceByYear,totalByStatus:e.data.totalByStatus})),setTimeout((function(){U(!0),$(1)}),1e3)})).catch((function(a){$(1),e.tokenExpired(a)}))},displayFilter:Z,configGeneral:e.configGeneral}),l.a.createElement(u.a,null,l.a.createElement(d.a,{sm:12,md:12,lg:12,xs:12},l.a.createElement(m.a,{columns:w,data:z})))),l.a.createElement(S.a,{isOpenModalDetail:F,handleModalDetail:ge,cotizationDetail:M,configGeneral:e.configGeneral,isGuide:!0}),l.a.createElement(C.a,{isShow:ue,onHide:me,cotization:le,printInvoice:function(e){p.b.info("Cargando documento, espere por favor"),window.open(e.name_pdf,"_blank")},goToInvoice:function(a){e.history.replace("/guide/guide_invoice/"+a)},anulateInvoice:function(e){Object(N.confirmAlert)({customUI:function(a){var t=a.onClose;return l.a.createElement("div",{className:"custom-ui-edit"},l.a.createElement("h1",null,"\xbfEsta seguro?"),l.a.createElement("p",{className:"font-alert"},"\xbfDesea realmente anular este registro?"),l.a.createElement("button",{className:"button-alert",onClick:function(){pe(e.id),t()}},"Si, Aceptar"),l.a.createElement("button",{className:"button-alert",onClick:t},"No"))}})},seeDetailCotization:function(e){P(e),ge()},isGuide:!0}))}))}}]);