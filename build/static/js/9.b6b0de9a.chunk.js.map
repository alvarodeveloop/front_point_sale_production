{"version":3,"sources":["pages/SaleNoteBondPage.jsx"],"names":["bondColumns","connect","state","id_branch_office","enterpriseSucursal","configGeneral","configs","config","configStore","props","useState","invoice","setInvoice","bonds","setBonds","typeBond","setTypeBond","isShow","setIsShow","disableButton","validated","setValidated","notify_client","amount","id_type_bond","detail","date_payment_bond","moment","tz","format","formBond","setFormBond","displayLoading","setDisplayLoading","count","id_branch","useEffect","fetchData","setTimeout","history","replace","fetchTypeBond","useMemo","Header","accessor","props1","type_bond","name","showPriceWithDecimals","Cell","variant","className","simbolo_moneda","cell","row","original","status","size","id","title","block","Item","onClick","modifyRegisterBond","deleteRegisterBond","match","params","promise","axios","get","API_URL","Promise","all","then","result","data","catch","err","tokenExpired","handleModalBond","onChange","e","target","checked","value","datos","confirmAlert","customUI","onClose","confirmDeleteRegister","delete","toast","success","fluid","sm","md","lg","folio_bill","type","length","error","wb","xlsx","book_new","bodyTable","Props","Title","ref","Subject","Author","CreatedDate","SheetNames","push","forEach","item","i","ws","aoa_to_sheet","Sheets","wbout","bookType","s2ab","FileSaver","saveAs","Blob","disabled","responseType","window","open","columns","show","onHide","aria-labelledby","centered","closeButton","onSubmit","form","currentTarget","preventDefault","checkValidity","stopPropagation","objectPost","Object","assign","id_invoice","put","post","noValidate","Body","label","required","messageErrors","cols","handleChange","map","v","key","step","Footer"],"mappings":"wZA+BIA,EAAc,GA4aHC,uBARf,SAAyBC,GACvB,MAAO,CACLC,iBAAkBD,EAAME,mBAAmBD,iBAC3CE,cAAgBH,EAAMI,QAAQC,OAC9BC,YAAaN,EAAMI,QAAQE,eAIQ,GAAxBP,EA1aU,SAACQ,GAAW,IAAD,EACLC,mBAAS,MADJ,mBAC3BC,EAD2B,KACnBC,EADmB,OAERF,mBAAS,IAFD,mBAE3BG,EAF2B,KAEpBC,EAFoB,OAGFJ,mBAAS,IAHP,mBAG3BK,EAH2B,KAGjBC,EAHiB,OAINN,oBAAS,GAJH,mBAI3BO,EAJ2B,KAInBC,EAJmB,OAKQR,oBAAS,GALjB,mBAK3BS,EAL2B,aAMAT,oBAAS,IANT,mBAM3BU,EAN2B,KAMhBC,EANgB,OAOFX,mBAAS,CACvCY,eAAe,EACfC,OAAQ,GACRC,aAAc,GACdC,OAAQ,GACRC,kBAAmBC,IAASC,GAAG,oBAAoBC,OAAO,gBAZ1B,mBAO3BC,GAP2B,KAOjBC,GAPiB,QAcUrB,oBAAS,GAdnB,qBAc3BsB,GAd2B,MAcXC,GAdW,MAgB9BC,GAAQ,EACRC,GAAY,KAEhBC,qBAAU,WACK,IAAVF,IACDC,GAAY1B,EAAMN,iBAClB+B,KACAG,MAEGF,KAAc1B,EAAMN,iBACrBmC,YAAW,WACT7B,EAAM8B,QAAQC,QAAQ,6BACrB,OAEHN,KACAG,QAGJ,CAAC5B,EAAMN,mBAETiC,qBAAU,WACRK,OACA,IAEFC,mBAAQ,WACN1C,EAAc,CACZ,CACE2C,OAAQ,QACRC,SAAU,SAAAC,GAAM,MAAI,CAAClB,EAAOkB,EAAOnB,mBAAmBG,OAAO,iBAE/D,CACEc,OAAQ,UACRC,SAAU,UAEZ,CACED,OAAQ,gBACRC,SAAU,SAAAC,GAAM,MAAI,CAACA,EAAOC,UAAUC,QAExC,CACEJ,OAAQ,QACRC,SAAU,SAAAC,GAAM,MAAI,CAACG,YAAsBvC,EAAMJ,cAAcwC,EAAOtB,UACtE0B,KAAO,SAAAJ,GACL,OAAO,kBAAC,IAAD,CAAOK,QAAQ,SAASC,UAAU,cAAc1C,EAAMJ,cAAc+C,eAAgBJ,YAAsBvC,EAAMJ,cAAcwC,EAAOQ,KAAKC,IAAIC,SAAShC,WAGlK,CACEoB,OAAQ,WACRM,KAAM,SAAAJ,GACJ,IAAMU,EAAWV,EAAOQ,KAAKC,IAAIC,SACjC,OAAG5C,GAA8B,IAAnBA,EAAQ6C,OACb,GAGL,kBAAC,IAAD,CAAgBC,KAAK,KAAKC,GAAI,OAAOH,EAASG,GAAIC,MAAM,aAAcC,MAAM,QAC1E,kBAAC,IAASC,KAAV,CAAeC,QAAS,kBAAMC,GAAmBR,KAAjD,aACA,kBAAC,IAASM,KAAV,CAAeC,QAAS,kBAAME,GAAmBT,KAAjD,kBAOZ,CAAC5C,IAEH,IAAM0B,GAAY,WAChB,IAAMqB,EAAKjD,EAAMwD,MAAMC,OAAOR,GACxBS,EAAU,CACdC,IAAMC,IAAIC,IAAQ,WAAWZ,EAAnBY,OAEZC,QAAQC,IAAIL,GAASM,MAAK,SAAAC,GACxB9D,EAAW8D,EAAO,GAAGC,MACrB7D,EAAS4D,EAAO,GAAGC,KAAK9D,OACxBoB,IAAkB,MACjB2C,OAAM,SAAAC,GACP5C,IAAkB,GAClBxB,EAAMqE,aAAaD,OAIjBpC,GAAgB,WACpB2B,IAAMC,IAAIC,IAAQ,aAAaG,MAAK,SAAAC,GAChC1D,EAAY0D,EAAOC,SAClBC,OAAM,SAAAC,GACPpE,EAAMqE,aAAaD,OAsCnBE,GAAkB,WACnB9D,GACDc,GAAY,CACVT,eAAe,EACfC,OAAQ,GACRC,aAAc,GACdC,OAAQ,GACRC,kBAAmBC,IAASC,GAAG,oBAAoBC,OAAO,gBAG9DX,GAAWD,IAIP+D,GAAW,SAAAC,GACflD,GAAY,2BAAID,IAAL,kBAAgBmD,EAAEC,OAAOnC,KAA0B,kBAAlBkC,EAAEC,OAAOnC,KAA2BkC,EAAEC,OAAOC,QAAUF,EAAEC,OAAOE,UAGxGrB,GAAqB,SAAAsB,GACzBtD,GAAY,CACVT,cAAe+D,EAAM/D,cACrBC,OAAQ8D,EAAM9D,OACdC,aAAc6D,EAAM7D,aACpBC,OAAQ4D,EAAM5D,OACdC,kBAAmBC,EAAO0D,EAAM3D,mBAAmBE,GAAG,oBAAoBC,OAAO,cACjF6B,GAAI2B,EAAM3B,KAGZqB,MAGIf,GAAqB,SAAAqB,GACzBC,uBAAa,CACXC,SAAU,YAAkB,IAAfC,EAAc,EAAdA,QACX,OACE,yBAAKrC,UAAU,kBACb,gDACA,uBAAGA,UAAU,cAAb,6CACA,4BAAQA,UAAU,eAChBW,QAAS,WACP2B,GAAsBJ,EAAM3B,IAC5B8B,MAHJ,eAQA,4BAAQrC,UAAU,eAAeW,QAAS0B,GAA1C,WAOJC,GAAwB,SAAA/B,GAC5BzB,IAAkB,GAClBmC,IAAMsB,OAAOpB,IAAQ,iBAAiBZ,GAAIe,MAAK,SAAAC,GAC9CiB,IAAMC,QAAQ,gCACdvD,QACEuC,OAAM,SAAAC,GACP5C,IAAkB,GAClBxB,EAAMqE,aAAaD,OAwEvB,OACE,kBAAC,IAAD,CAAWgB,OAAK,GACd,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKC,GAAI,EAAGC,GAAI,EAAGC,GAAI,GACrB,wBAAI7C,UAAU,mBAAd,iCAA+DxC,EAAY,kBAAC,IAAD,CAAOuC,QAAQ,SAASC,UAAU,cAAcxC,EAAQsF,YAAuB,KAE5J,kBAAC,IAAD,CAAKH,GAAI,EAAGC,GAAI,EAAGC,GAAI,GACrB,kBAAC,IAAD,CAAQ9C,QAAQ,UAAUU,OAAO,EAAMsC,KAAK,SAASpC,QAtBzC,WAClBrD,EAAM8B,QAAQC,QAAQ,gCAqB2DiB,KAAK,MAAhF,wBAGHzB,GACC,kBAAC,IAAD,MAEA,oCACE,kBAAC,IAAD,CACErB,QAASA,EACTN,cAAeI,EAAMJ,cACrBG,YAAaC,EAAMD,cAErB,6BACA,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKsF,GAAI,EAAGC,GAAI,EAAGC,GAAI,GACrB,kBAAC,IAAD,CAAQ9C,QAAQ,UAAUU,OAAO,EAAMsC,KAAK,SAASpC,QA1F3C,WAEpB,GAAGjD,EAAMsF,OAAS,EAChBR,IAAMS,MAAM,mDACT,CACHnE,IAAkB,GAClB,IAAIoE,EAAKC,QAAWC,WAChBC,EAAY,CAAC,CAAC,QAAQ,UAAU,gBAAgB,UAEpDH,EAAGI,MAAQ,CACTC,MAAO,sCAAsC/F,EAAQgG,IACrDC,QAAS,yBACTC,OAAQ,iBACRC,YAAanF,IAASE,OAAO,eAE/BwE,EAAGU,WAAWC,KAAK,SAEnBnG,EAAMoG,SAAQ,SAACC,EAAMC,GACnBX,EAAUQ,KAAK,CACbrF,EAAOuF,EAAKxF,mBAAmBG,OAAO,cACtCqF,EAAKzF,OACLyF,EAAKpE,UAAUC,KACfC,YAAsBvC,EAAMJ,cAAc6G,EAAK3F,aAInD,IAAI6F,EAAKd,QAAWe,aAAab,GACjCH,EAAGiB,OAAH,MAAqBF,EACrB,IAAIG,EAAQjB,QAAWD,EAAI,CAACmB,SAAS,OAAStB,KAAM,WAChDb,EAAQoC,YAAKF,GACjBG,IAAUC,OAAO,IAAIC,KAAK,CAACvC,GAAO,CAACa,KAAK,6BAA8B,8BAA8BvF,EAAQgG,IAAI,WAAWhF,IAASC,GAAG,oBAAoBC,OAAO,cAAc,SAChLI,IAAkB,KA2DmEwB,KAAK,MAAlF,oBAAwG,kBAAC,IAAD,QAE1G,kBAAC,IAAD,CAAKqC,GAAI,EAAGC,GAAI,EAAGC,GAAI,GACrB,kBAAC,IAAD,CAAQ9C,QAAQ,UAAUU,OAAO,EAAMsC,KAAK,SAASpC,QAASiB,GAAiBtB,KAAK,KAAKoE,YAAUlH,GAA8B,IAAnBA,EAAQ6C,SAAtH,iBAAiK,kBAAC,IAAD,QAEnK,kBAAC,IAAD,CAAKsC,GAAI,EAAGC,GAAI,EAAGC,GAAI,GACrB,kBAAC,IAAD,CAAQ9C,QAAQ,UAAUU,OAAO,EAAMsC,KAAK,SAASpC,QA5D7C,WACfjD,EAAMsF,OAAS,GAChBlE,IAAkB,GAClBmC,IAAMC,IAAIC,IAAQ,uBAAuB7D,EAAMwD,MAAMC,OAAOR,GAAG,KAAK,CAClEoE,aAAc,SACbrD,MAAK,SAAAC,GACNgD,IAAUC,OAAOjD,EAAOC,KAAK,6CAA6ChE,EAAQgG,IAAI,WAAWhF,IAASC,GAAG,oBAAoBC,OAAO,cAAc,QACtJI,IAAkB,MACjB2C,OAAM,SAAAC,GACP5C,IAAkB,GAClBxB,EAAMqE,aAAaD,OAGrBc,IAAMS,MAAM,0CA+CuE3C,KAAK,MAAhF,kBAAoG,kBAAC,IAAD,QAEtG,kBAAC,IAAD,CAAKqC,GAAI,EAAGC,GAAI,EAAGC,GAAI,GACrB,kBAAC,IAAD,CAAQ9C,QAAQ,UAAUU,OAAO,EAAMsC,KAAK,SAASpC,QA1C5C,WACnB7B,IAAkB,GAClBmC,IAAMC,IAAIC,IAAQ,iBAAiB7D,EAAMwD,MAAMC,OAAOR,GAAG,QAASe,MAAK,SAAAC,GACrEqD,OAAOC,KAAK1D,IAAQ,iCAAiCI,EAAOC,KAAK5B,MACjEd,IAAkB,MACjB2C,OAAM,SAAAC,GACP5C,IAAkB,GAClBxB,EAAMqE,aAAaD,OAmCiEpB,KAAK,MAAjF,oBAAuG,kBAAC,IAAD,SAG3G,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKqC,GAAI,GAAIC,GAAI,GAAIC,GAAI,IACvB,6BACA,kBAAC,IAAD,CAAOiC,QAASjI,EAAa2E,KAAM9D,OAM3C,kBAAC,IAAD,CACEqH,KAAMjH,EACNkH,OAAQpD,GACRtB,KAAK,KACL2E,kBAAgB,gCAChBC,UAAQ,GAER,kBAAC,IAAM1F,OAAP,CAAc2F,aAAW,EAACnF,UAAU,eAClC,kBAAC,IAAMuD,MAAP,CAAahD,GAAG,iCAAhB,oBAIF,kBAAC,IAAD,CAAM6E,SA7Na,SAAAtD,GACvB,IAAMuD,EAAOvD,EAAEwD,cAEf,GADAxD,EAAEyD,kBAC2B,IAAzBF,EAAKG,gBAGP,OAFA1D,EAAE2D,uBACFvH,GAAa,GAIf,IAAIwH,EAAaC,OAAOC,OAAO,GAAGjH,GAAS,CACzCkH,WAAYvI,EAAMwD,MAAMC,OAAOR,KAEjCzB,IAAkB,GACf4G,EAAWnF,GACZU,IAAM6E,IAAI3E,IAAQ,iBAAiBuE,EAAWnF,GAAGmF,GAAYpE,MAAK,SAAAC,GAChEiB,IAAMC,QAAQ,iCACdb,KACA1C,QACCuC,OAAM,SAAAC,GACP5C,IAAkB,GAClBxB,EAAMqE,aAAaD,MAGrBT,IAAM8E,KAAK5E,IAAQ,gBAAgBuE,GAAYpE,MAAK,SAAAC,GAClDiB,IAAMC,QAAQ,+BACdb,KACA1C,QACCuC,OAAM,SAAAC,GACP5C,IAAkB,GAClBxB,EAAMqE,aAAaD,OAgMesE,YAAU,EAAC/H,UAAWA,GACrDY,GACC,kBAAC,IAAMoH,KAAP,KACE,kBAAC,IAAD,OAGF,oCACE,kBAAC,IAAMA,KAAP,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CACAlD,KAAK,OACLmD,MAAM,iBACNtG,KAAK,oBACLuG,UAAU,EACVC,cAAe,CACf,cAEAC,KAAK,6BACLpE,MAAOtD,GAASJ,kBAChB+H,aAAczE,KAEhB,kBAAC,IAAD,CACEkB,KAAK,SACLmD,MAAM,gBACNtG,KAAK,eACLuG,UAAU,EACVC,cAAe,CACf,cAEAC,KAAK,6BACLpE,MAAOtD,GAASN,aAChBiI,aAAczE,IAEd,4BAAQI,MAAM,IAAd,kBACCrE,EAAS2I,KAAI,SAACC,EAAExC,GAAH,OACZ,4BAAQ/B,MAAOuE,EAAEjG,GAAIkG,IAAKzC,GAAIwC,EAAE5G,UAGlC,kBAAC,IAAD,CACAmD,KAAK,SACL2D,KAAK,MACLR,MAAM,QACNtG,KAAK,SACLuG,UAAU,EACVC,cAAe,CACf,cAEAC,KAAK,6BACLpE,MAAOtD,GAASP,OAChBkI,aAAczE,MAGhB,kBAAC,IAAD,KACE,kBAAC,IAAD,CACAkB,KAAK,OACLmD,MAAM,UACNtG,KAAK,SACLuG,UAAU,EACVC,cAAe,CACf,cAEAC,KAAK,6BACLpE,MAAOtD,GAASL,OAChBgI,aAAczE,QAoBtB,kBAAC,IAAM8E,OAAP,KACE,kBAAC,IAAD,CAAQrG,KAAK,KAAKyC,KAAK,SAAShD,QAAQ,UAAW2E,SAAU1G,GAA7D,UACA,kBAAC,IAAD,CAAQsC,KAAK,KAAKP,QAAQ,YAAYY,QAASiB,GAAiB8C,SAAU1G,GAA1E","file":"static/js/9.b6b0de9a.chunk.js","sourcesContent":["import React, {useState, useEffect, useMemo} from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport {connect} from 'react-redux'\r\nimport {API_URL} from 'utils/constants'\r\nimport 'styles/components/modalComponents.css'\r\nimport {\r\n  Row,\r\n  Col,\r\n  Container,\r\n  Button,\r\n  Badge,\r\n  Modal,\r\n  Form,\r\n  DropdownButton,\r\n  Dropdown,\r\n  Image\r\n} from 'react-bootstrap'\r\nimport InvoiceBondComponent from 'components/InvoiceBondComponent'\r\nimport axios from 'axios'\r\nimport { toast } from 'react-toastify'\r\nimport {FaPlusCircle, FaRegFileCode , FaRegFilePdf} from 'react-icons/fa'\r\nimport InputField from 'components/input/InputComponent'\r\nimport * as moment from 'moment-timezone'\r\nimport { confirmAlert } from 'react-confirm-alert'; // Import\r\n\r\nimport {showPriceWithDecimals, s2ab} from 'utils/functions'\r\nimport * as xlsx from 'xlsx'\r\nimport Table from 'components/Table'\r\nimport FileSaver from 'file-saver'\r\nimport LoadingComponent from 'components/LoadingComponent'\r\n\r\nlet bondColumns = []\r\n\r\nconst SaleNoteBondPage = (props) => {\r\n  const [invoice,setInvoice] = useState(null)\r\n  const [bonds, setBonds] = useState([])\r\n  const [typeBond, setTypeBond] = useState([])\r\n  const [isShow, setIsShow] = useState(false)\r\n  const [disableButton, setDisableButton] = useState(false)\r\n  const [validated, setValidated] = useState(false)\r\n  const [formBond, setFormBond] = useState({\r\n    notify_client: false,\r\n    amount: \"\",\r\n    id_type_bond: \"\",\r\n    detail: \"\",\r\n    date_payment_bond: moment().tz('America/Santiago').format('YYYY-MM-DD')\r\n  })\r\n  const [displayLoading, setDisplayLoading] = useState(false)\r\n\r\n  let count = 0\r\n  let id_branch = null\r\n\r\n  useEffect(() => {\r\n    if(count === 0){\r\n      id_branch = props.id_branch_office\r\n      count++\r\n      fetchData()\r\n    }else{\r\n      if(id_branch !== props.id_branch_office){\r\n        setTimeout(function () {\r\n          props.history.replace('/invoice/invoice_search')\r\n        }, 1500);\r\n      }else{\r\n        count++\r\n        fetchData()\r\n      }\r\n    }\r\n  },[props.id_branch_office])\r\n\r\n  useEffect(() => {\r\n    fetchTypeBond()\r\n  },[])\r\n\r\n  useMemo(() => {\r\n    bondColumns = [\r\n      {\r\n        Header: 'Fecha',\r\n        accessor: props1 => [moment(props1.date_payment_bond).format('DD-MM-YYYY')],\r\n      },\r\n      {\r\n        Header: 'Detalle',\r\n        accessor: 'detail',\r\n      },\r\n      {\r\n        Header: 'Tipo de Abono',\r\n        accessor: props1 => [props1.type_bond.name],\r\n      },\r\n      {\r\n        Header: 'Monto',\r\n        accessor: props1 => [showPriceWithDecimals(props.configGeneral,props1.amount)],\r\n        Cell : props1 => {\r\n          return <Badge variant=\"danger\" className=\"font-badge\">{props.configGeneral.simbolo_moneda}{showPriceWithDecimals(props.configGeneral,props1.cell.row.original.amount)}</Badge>\r\n        }\r\n      },\r\n      {\r\n        Header: 'Acciones',\r\n        Cell: props1 => {\r\n          const original = props1.cell.row.original\r\n          if(invoice && invoice.status === 2){\r\n            return ''\r\n          }else{\r\n            return(\r\n              <DropdownButton size=\"sm\" id={'drop'+original.id} title=\"Seleccione\"  block=\"true\">\r\n                <Dropdown.Item onClick={() => modifyRegisterBond(original)}>Modificar</Dropdown.Item>\r\n                <Dropdown.Item onClick={() => deleteRegisterBond(original)}>Eliminar</Dropdown.Item>\r\n              </DropdownButton>\r\n            )\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  },[invoice])\r\n\r\n  const fetchData = () => {\r\n    const id = props.match.params.id\r\n    const promise = [\r\n      axios.get(API_URL+'invoice/'+id+\"/\"+2),\r\n    ]\r\n    Promise.all(promise).then(result => {\r\n      setInvoice(result[0].data)\r\n      setBonds(result[0].data.bonds)\r\n      setDisplayLoading(false)\r\n    }).catch(err => {\r\n      setDisplayLoading(false)\r\n      props.tokenExpired(err)\r\n    })\r\n  }\r\n\r\n  const fetchTypeBond = () => {\r\n    axios.get(API_URL+'type_bond').then(result => {\r\n        setTypeBond(result.data)\r\n      }).catch(err => {\r\n        props.tokenExpired(err)\r\n    })\r\n  }\r\n\r\n  const handleSubmitBold = e => {\r\n    const form = e.currentTarget;\r\n    e.preventDefault();\r\n    if (form.checkValidity() === false) {\r\n      e.stopPropagation();\r\n      setValidated(true);\r\n      return\r\n    }\r\n\r\n    let objectPost = Object.assign({},formBond,{\r\n      id_invoice: props.match.params.id\r\n    })\r\n    setDisplayLoading(true)\r\n    if(objectPost.id){\r\n      axios.put(API_URL+'invoice_bonds/'+objectPost.id,objectPost).then(result => {\r\n        toast.success('Abono modificado con éxito')\r\n        handleModalBond()\r\n        fetchData()\r\n      }).catch(err => {\r\n        setDisplayLoading(false)\r\n        props.tokenExpired(err)\r\n      })\r\n    }else{\r\n      axios.post(API_URL+'invoice_bonds',objectPost).then(result => {\r\n        toast.success('Abono agregado con éxito')\r\n        handleModalBond()\r\n        fetchData()\r\n      }).catch(err => {\r\n        setDisplayLoading(false)\r\n        props.tokenExpired(err)\r\n      })\r\n    }\r\n  }\r\n\r\n  const handleModalBond = () => {\r\n    if(isShow){\r\n      setFormBond({\r\n        notify_client: false,\r\n        amount: \"\",\r\n        id_type_bond: \"\",\r\n        detail: \"\",\r\n        date_payment_bond: moment().tz('America/Santiago').format('YYYY-MM-DD')\r\n      })\r\n    }\r\n    setIsShow(!isShow)\r\n\r\n  }\r\n\r\n  const onChange = e => {\r\n    setFormBond({...formBond, [e.target.name] : e.target.name === \"notify_client\" ? e.target.checked : e.target.value})\r\n  }\r\n\r\n  const modifyRegisterBond = datos => {\r\n    setFormBond({\r\n      notify_client: datos.notify_client,\r\n      amount: datos.amount,\r\n      id_type_bond: datos.id_type_bond,\r\n      detail: datos.detail,\r\n      date_payment_bond: moment(datos.date_payment_bond).tz('America/Santiago').format('YYYY-MM-DD'),\r\n      id: datos.id\r\n    })\r\n\r\n    handleModalBond()\r\n  }\r\n\r\n  const deleteRegisterBond = datos => {\r\n    confirmAlert({\r\n      customUI: ({ onClose }) => {\r\n        return (\r\n          <div className='custom-ui-edit'>\r\n            <h1>¿Esta seguro?</h1>\r\n            <p className=\"font-alert\">¿Desea realmente borrar este registro?</p>\r\n            <button className=\"button-alert\"\r\n              onClick={() => {\r\n                confirmDeleteRegister(datos.id);\r\n                onClose();\r\n              }}\r\n            >\r\n              Si, Aceptar\r\n            </button>\r\n            <button className=\"button-alert\" onClick={onClose}>No</button>\r\n          </div>\r\n        );\r\n      }\r\n    });\r\n  }\r\n\r\n  const confirmDeleteRegister = id  => {\r\n    setDisplayLoading(true)\r\n    axios.delete(API_URL+'invoice_bonds/'+id).then(result => {\r\n     toast.success('Abono eliminado con éxito')\r\n     fetchData()\r\n    }).catch(err => {\r\n      setDisplayLoading(false)\r\n      props.tokenExpired(err)\r\n    })\r\n  }\r\n\r\n  const exportToExcel = () => {\r\n\r\n    if(bonds.length < 1){\r\n      toast.error('Error, no hay abonos para realizar el excel')\r\n    }else{\r\n      setDisplayLoading(true)\r\n      let wb = xlsx.utils.book_new()\r\n      let bodyTable = [['Fecha','Detalle','Tipo de Abono','Monto']]\r\n\r\n      wb.Props = {\r\n        Title: \"Pagos abonados de la nota de venta \"+invoice.ref,\r\n        Subject: \"Exportación de Data\",\r\n        Author: 'Aidy tecnology',\r\n        CreatedDate: moment().format('YYYY-MM-DD')\r\n      };\r\n      wb.SheetNames.push(\"Pagos\");\r\n\r\n      bonds.forEach((item, i) => {\r\n        bodyTable.push([\r\n          moment(item.date_payment_bond).format('DD-MM-YYYY'),\r\n          item.detail,\r\n          item.type_bond.name,\r\n          showPriceWithDecimals(props.configGeneral,item.amount)\r\n        ])\r\n      });\r\n\r\n      var ws = xlsx.utils.aoa_to_sheet(bodyTable);\r\n      wb.Sheets[\"Pagos\"] = ws;\r\n      var wbout = xlsx.write(wb, {bookType:'xlsx',  type: 'binary'});\r\n      let datos = s2ab(wbout)\r\n      FileSaver.saveAs(new Blob([datos],{type:\"application/octet-stream\"}), 'Abonos de la nota de venta '+invoice.ref+\" fecha: \"+moment().tz('America/Santiago').format('DD-MM-YYYY')+'.xlsx')\r\n      setDisplayLoading(false)\r\n    }\r\n\r\n  }\r\n\r\n  const exportToPdf = () => {\r\n    if(bonds.length > 0){\r\n      setDisplayLoading(true)\r\n      axios.get(API_URL+'print_invoice_bonds/'+props.match.params.id+'/2',{\r\n        responseType: 'blob'\r\n      }).then(result => {\r\n        FileSaver.saveAs(result.data,'Informe de los pagos de la nota de venta: '+invoice.ref+' fecha: '+moment().tz('America/Santiago').format('DD-MM-YYYY')+\".pdf\")\r\n        setDisplayLoading(false)\r\n      }).catch(err => {\r\n        setDisplayLoading(false)\r\n        props.tokenExpired(err)\r\n      })\r\n    }else{\r\n      toast.error('No hay pagos para realizar el informe')\r\n    }\r\n  }\r\n\r\n  const goToInvoice = () => {\r\n    props.history.replace('/sale_note/sale_note_search')\r\n  }\r\n\r\n  const printInvoice = () => {\r\n    setDisplayLoading(true)\r\n    axios.get(API_URL+'invoice_print/'+props.match.params.id+\"/0/2\",).then(result => {\r\n      window.open(API_URL+'documents/sale_note/files_pdf/'+result.data.name)\r\n      setDisplayLoading(false)\r\n    }).catch(err => {\r\n      setDisplayLoading(false)\r\n      props.tokenExpired(err)\r\n    })\r\n  }\r\n\r\n  return (\r\n    <Container fluid>\r\n      <Row>\r\n        <Col sm={7} md={7} lg={7}>\r\n          <h4 className=\"title_principal\">Historial de Pagos de la Nota {invoice  ? (<Badge variant=\"danger\" className=\"font-badge\">{invoice.folio_bill}</Badge>) : ''}</h4>\r\n        </Col>\r\n        <Col sm={5} md={5} lg={5}>\r\n          <Button variant=\"primary\" block={true} type=\"button\" onClick={goToInvoice} size=\"sm\">Volver a las Notas</Button>\r\n        </Col>\r\n      </Row>\r\n      {displayLoading ? (\r\n        <LoadingComponent />\r\n      ) : (\r\n        <>\r\n          <InvoiceBondComponent\r\n            invoice={invoice}\r\n            configGeneral={props.configGeneral}\r\n            configStore={props.configStore}\r\n          />\r\n          <br/>\r\n          <Row>\r\n            <Col sm={3} md={3} lg={3}>\r\n              <Button variant=\"success\" block={true} type=\"button\" onClick={exportToExcel} size=\"sm\">Exportar a Excel <FaRegFileCode /></Button>\r\n            </Col>\r\n            <Col sm={3} md={3} lg={3}>\r\n              <Button variant=\"success\" block={true} type=\"button\" onClick={handleModalBond} size=\"sm\" disabled={invoice && invoice.status === 2 ? true : false}>Agregar Abono <FaPlusCircle /></Button>\r\n            </Col>\r\n            <Col sm={3} md={3} lg={3}>\r\n              <Button variant=\"success\" block={true} type=\"button\" onClick={exportToPdf} size=\"sm\">Exportar a Pdf <FaRegFilePdf /></Button>\r\n            </Col>\r\n            <Col sm={3} md={3} lg={3}>\r\n              <Button variant=\"success\" block={true} type=\"button\" onClick={printInvoice} size=\"sm\">Imprimir Factura <FaRegFilePdf /></Button>\r\n            </Col>\r\n          </Row>\r\n          <Row>\r\n            <Col sm={12} md={12} lg={12}>\r\n              <br/>\r\n              <Table columns={bondColumns} data={bonds} />\r\n            </Col>\r\n          </Row>\r\n        </>\r\n      )}\r\n\r\n      <Modal\r\n        show={isShow}\r\n        onHide={handleModalBond}\r\n        size=\"xl\"\r\n        aria-labelledby=\"contained-modal-title-vcenter\"\r\n        centered\r\n      >\r\n        <Modal.Header closeButton className=\"header_dark\">\r\n          <Modal.Title id=\"contained-modal-title-vcenter\">\r\n            Agregar Abono $\r\n          </Modal.Title>\r\n        </Modal.Header>\r\n        <Form onSubmit={handleSubmitBold} noValidate validated={validated}>\r\n          {displayLoading ? (\r\n            <Modal.Body>\r\n              <LoadingComponent />\r\n            </Modal.Body>\r\n          ) : (\r\n            <>\r\n              <Modal.Body>\r\n                <Row>\r\n                  <InputField\r\n                  type='date'\r\n                  label='Fecha del Pago'\r\n                  name='date_payment_bond'\r\n                  required={true}\r\n                  messageErrors={[\r\n                  'Requerido*'\r\n                  ]}\r\n                  cols='col-md-4 col-lg-4 col-sm-4'\r\n                  value={formBond.date_payment_bond}\r\n                  handleChange={onChange}\r\n                  />\r\n                <InputField\r\n                  type='select'\r\n                  label='Tipo de Abono'\r\n                  name='id_type_bond'\r\n                  required={true}\r\n                  messageErrors={[\r\n                  'Requerido*'\r\n                  ]}\r\n                  cols='col-md-4 col-lg-4 col-sm-4'\r\n                  value={formBond.id_type_bond}\r\n                  handleChange={onChange}\r\n                  >\r\n                  <option value=\"\">--Seleccione--</option>\r\n                  {typeBond.map((v,i) => (\r\n                    <option value={v.id} key={i}>{v.name}</option>\r\n                  ))}\r\n                </InputField>\r\n                  <InputField\r\n                  type='number'\r\n                  step=\"any\"\r\n                  label='Monto'\r\n                  name='amount'\r\n                  required={true}\r\n                  messageErrors={[\r\n                  'Requerido*'\r\n                  ]}\r\n                  cols='col-md-4 col-lg-4 col-sm-4'\r\n                  value={formBond.amount}\r\n                  handleChange={onChange}\r\n                  />\r\n                </Row>\r\n                <Row>\r\n                  <InputField\r\n                  type='text'\r\n                  label='Detalle'\r\n                  name='detail'\r\n                  required={false}\r\n                  messageErrors={[\r\n                  'Requerido*'\r\n                  ]}\r\n                  cols='col-md-4 col-lg-4 col-sm-4'\r\n                  value={formBond.detail}\r\n                  handleChange={onChange}\r\n                  />\r\n                {/*\r\n                  <Col sm={4} md={4} lg={4}>\r\n                    <br/>\r\n                    <Form.Group>\r\n                      <Form.Check\r\n                        name=\"notify_client\"\r\n                        type={'checkbox'}\r\n                        id={`checkbox-1`}\r\n                        label={`Notificar al Cliente`}\r\n                        checked={formBond.notify_client}\r\n                        onChange={onChange}\r\n                        />\r\n                    </Form.Group>\r\n                  </Col>*/}\r\n                </Row>\r\n              </Modal.Body>\r\n            </>\r\n          )}\r\n          <Modal.Footer>\r\n            <Button size=\"md\" type=\"submit\" variant=\"primary\"  disabled={disableButton}>Enviar</Button>\r\n            <Button size=\"md\" variant=\"secondary\" onClick={handleModalBond} disabled={disableButton}>cerrar</Button>\r\n          </Modal.Footer>\r\n        </Form>\r\n      </Modal>\r\n    </Container>\r\n  )\r\n}\r\n\r\n\r\nfunction mapStateToProps(state){\r\n  return {\r\n    id_branch_office: state.enterpriseSucursal.id_branch_office,\r\n    configGeneral : state.configs.config,\r\n    configStore: state.configs.configStore\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps,{})(SaleNoteBondPage)\r\n"],"sourceRoot":""}