(this["webpackJsonpappwork-react-starter"]=this["webpackJsonpappwork-react-starter"]||[]).push([[81],{801:function(e,a,t){"use strict";t.r(a);var n=t(20),o=t(16),l=t(1),c=t.n(l),r=t(305),i=t(615),s=t(614),u=t(604),d=t(205),m=t(618),b=t(9),f=t.n(b),g=t(10),_=t(8),p=t(18),E=t(32),v=t(620),h=t(619),j=t(55),y=t(165),O=(t(311),t(29)),N=t(646),C=t(621),G=t(647),k=t(83),S=t(666),w=null;a.default=Object(O.b)((function(e){return{id_branch_office:e.enterpriseSucursal.id_branch_office,id_enterprise:e.enterpriseSucursal.id_enterprise,configGeneral:e.configs.config,configStore:e.configs.configStore}}),{})((function(e){var a=Object(l.useState)(!0),t=Object(o.a)(a,2),b=t[0],O=t[1],B=Object(l.useState)([]),H=Object(o.a)(B,2),z=H[0],D=H[1],F=Object(l.useState)({}),T=Object(o.a)(F,2),x=T[0],M=T[1],A=Object(l.useState)(!1),R=Object(o.a)(A,2),Y=R[0],P=R[1],V=Object(l.useState)(!1),I=Object(o.a)(V,2),J=I[0],q=I[1],U=Object(l.useState)({}),K=Object(o.a)(U,2),L=K[0],Q=K[1],W=Object(l.useState)(1),X=Object(o.a)(W,2),Z=X[0],$=X[1],ee=Object(l.useState)({date_desde:"",date_hasta:"",type:2}),ae=Object(o.a)(ee,2),te=ae[0],ne=ae[1],oe=Object(l.useState)({}),le=Object(o.a)(oe,2),ce=le[0],re=le[1],ie=Object(l.useState)(!1),se=Object(o.a)(ie,2),ue=se[0],de=se[1];Object(l.useMemo)((function(){w=[{Header:"Referencia",accessor:"ref",Cell:function(e){var a=e.cell.row.original;return c.a.createElement(v.a,{placement:"bottom",overlay:c.a.createElement(h.a,{id:"tooltip-disabled2"},"Hacer click para acceder a las acciones de la Nota")},c.a.createElement(r.a,{variant:"link",block:!0,type:"button",size:"sm",onClick:function(){return me(a)}},a.ref))}},{Header:"Referencia-Cotizaci\xf3n",accessor:"ref_cotizacion"},{Header:"Referencia-Venta",accessor:"ref_sale"},{Header:"Rut Cliente",accessor:"rut_client"},{Header:"Raz\xf3n Social",accessor:"business_name_client",Cell:function(e){var a=e.cell.row.original;return c.a.createElement(v.a,{placement:"right",overlay:c.a.createElement(h.a,{id:"tooltip-disabled2"},c.a.createElement("ul",{className:"list-group"},c.a.createElement("li",{className:"list-group-item"},c.a.createElement("b",null,"Vendedor: ")," ",a.name_seller),c.a.createElement("li",{className:"list-group-item"},c.a.createElement("b",null,"Fono del Vendedor: ")," ",a.phone_seller?a.phone_seller:"No posee"),c.a.createElement("li",{className:"list-group-item"},c.a.createElement("b",null,"Contacto")," ",a.name_contact?a.name_contact:"No posee"),c.a.createElement("li",{className:"list-group-item"},c.a.createElement("b",null,"Fono del Contacto: ")," ",a.phone_contact),c.a.createElement("li",{className:"list-group-item"},c.a.createElement("b",null,"Comentario: ")," ",a.comment)))},c.a.createElement(r.a,{variant:"link",size:"sm",block:!0,type:"button"},a.business_name_client))}},{Header:"Tipo",accessor:function(e){return 1==e.type_invoicing?["Afecta"]:["Excento"]}},{Header:"Fecha-Emisi\xf3n",accessor:function(e){return[y(e.date_issue_invoice).tz("America/Santiago").format("DD-MM-YYYY")]}},{Header:"D\xedas de Vencimiento",accessor:"days_expiration"},{Header:"Status",accessor:function(e){return 1==e.status?c.a.createElement(i.a,{variant:"secondary",className:"font-badge"},"Pendiente"):2==e.status?c.a.createElement(i.a,{variant:"secondary",className:"font-badge"},"Pagada"):3==e.status?c.a.createElement(i.a,{variant:"secondary",className:"font-badge"},"Vencida"):c.a.createElement(i.a,{variant:"secondary",className:"font-badge"},"Anulada")}},{Header:"Total Productos",accessor:"total_product",Cell:function(a){var t=a.cell.row.original;return c.a.createElement(v.a,{placement:"left",overlay:c.a.createElement(h.a,{id:"tooltip-total_pagar"+t.id},c.a.createElement("ul",{className:"list-group"},t.products.map((function(a,n){return c.a.createElement("li",{className:"list-group-item",key:n},c.a.createElement("b",null,"Producto"),": ",a.name_product,c.a.createElement("br",null),c.a.createElement("b",null,"Precio")," : ",e.configGeneral?e.configGeneral.simbolo_moneda:"",Object(p.l)(e.configGeneral,t.total_with_iva?a.price:a.total),c.a.createElement("br",null),c.a.createElement("b",null,"Cantidad"),": ",a.quantity)}))))},c.a.createElement(i.a,{variant:"info",className:"font-badge",style:{backgroundColor:"rgb(198, 196, 54)",color:"white"}},e.configGeneral?e.configGeneral.simbolo_moneda:"",Object(p.l)(e.configGeneral,t.total_product)))}},{Header:"Total gastos",accessor:"total_gastos",Cell:function(a){return c.a.createElement(i.a,{variant:"info",className:"font-badge",style:{backgroundColor:"rgb(198, 196, 54)",color:"white"}},e.configGeneral?e.configGeneral.simbolo_moneda:"",Object(p.l)(e.configGeneral,a.cell.row.original.total_gastos))}},{Header:"Total Iva",accessor:"total_iva",Cell:function(a){return c.a.createElement(i.a,{variant:"info",className:"font-badge",style:{backgroundColor:"rgb(198, 196, 54)",color:"white"}},e.configGeneral?e.configGeneral.simbolo_moneda:"",Object(p.l)(e.configGeneral,a.cell.row.original.total_iva))}},{Header:"Descuento o Recargo Global",accessor:"discount_global_total",Cell:function(a){var t=a.cell.row.original;return c.a.createElement(v.a,{placement:"left",overlay:c.a.createElement(h.a,{id:"tooltip-total_pagar"+t.id},t.ref_sale?c.a.createElement(c.a.Fragment,null,"Monto: ",t.type_discount_global?t.discount_global+"%":Object(p.l)(e.configGeneral,t.discount_global_amount),c.a.createElement("br",null),t.discount_global_amount>0?c.a.createElement(c.a.Fragment,null,c.a.createElement("b",null,"Tipo:")," ",t.type_discount_global?"Porcentaje":"Fijo"," - ",t.discount_or_recharge_discount_global?"Descuento":"Recarga"):""):c.a.createElement(c.a.Fragment,null,t.discount_global,"%"))},c.a.createElement(i.a,{variant:"info",className:"font-badge",style:{backgroundColor:"rgb(198, 196, 54)",color:"white"}},e.configGeneral?e.configGeneral.simbolo_moneda:"",Object(p.l)(e.configGeneral,t.discount_global_amount)))}},{Header:"Total Balance",accessor:"total_balance",Cell:function(a){return c.a.createElement(i.a,{variant:"info",className:"font-badge",style:{backgroundColor:"rgb(198, 196, 54)",color:"white"}},e.configGeneral?e.configGeneral.simbolo_moneda:"",Object(p.l)(e.configGeneral,a.cell.row.original.total_balance))}},{Header:"Abonado",accessor:"total_bond",Cell:function(a){return c.a.createElement(i.a,{variant:"danger",className:"font-badge"},e.configGeneral?e.configGeneral.simbolo_moneda:"",Object(p.l)(e.configGeneral,a.cell.row.original.total_bond))}},{Header:"Saldo Deudor",accessor:"debit_balance",Cell:function(a){return c.a.createElement(i.a,{variant:"danger",className:"font-badge"},e.configGeneral?e.configGeneral.simbolo_moneda:"",Object(p.l)(e.configGeneral,a.cell.row.original.debit_balance))}},{Header:"Acciones",Cell:function(e){var a=Object.assign({},e.cell.row.original);return c.a.createElement(r.a,{variant:"primary",block:!0,type:"button",size:"sm",onClick:function(){return me(a)}},"Acciones")}}]}),[]),Object(l.useEffect)((function(){return j.a.toggleCollapsed(),function(){w=null,j.a.toggleCollapsed()}}),[]),Object(l.useEffect)((function(){fe()}),[e.id_branch_office]),Object(l.useEffect)((function(){J&&be()}),[J]);var me=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!ue&&e&&re(e),de(!ue)},be=function(){setTimeout((function(){q(!1)}),2e3)},fe=function(){var a=Object.assign({},te),t=[f.a.get(g.b+"invoice/0/2"),f.a.post(g.b+"invoice_stadistics",a)];Promise.all(t).then((function(e){D(e[0].data),Q(Object(n.a)(Object(n.a)({},L),{},{statusesBonds:e[1].data.statusesBonds,statuses:e[1].data.statuses,bondsByMonth:e[1].data.bondsByMonth,invoiceByYear:e[1].data.invoiceByYear,totalByStatus:e[1].data.totalByStatus})),setTimeout((function(){q(!0)}),1e3),O(!1)})).catch((function(a){O(!1),e.tokenExpired(a)}))},ge=function(){P(!Y)},_e=function(a,t){_.b.info("Anulando nota, esto podr\xeda tardar algunos segundos... espere por favor"),O(!0);var o={type:t};f.a.put(g.b+"invoice_status/"+a,o).then((function(e){_.b.success("Nota de venta anulada con \xe9xito"),re(Object(n.a)(Object(n.a)({},ce),{},{status:4})),fe()})).catch((function(a){O(!1),e.tokenExpired(a)}))};return c.a.createElement(s.a,{fluid:!0},c.a.createElement(u.a,null,c.a.createElement(d.a,{sm:6,md:6,lg:6,className:"text-center"},c.a.createElement("h4",{className:"title_principal"},"Tabla de Notas de Ventas"),c.a.createElement(r.a,{block:!0,variant:"success",onClick:function(){e.history.replace("/sale_note/sale_note_create")},size:"sm"},"Nueva Nota ",c.a.createElement(E.z,null))),c.a.createElement(d.a,{sm:6,md:6,lg:6,className:"text-center title_principal"},c.a.createElement("h4",null,"Total Notas Realizadas"),c.a.createElement(i.a,{variant:"danger"},z.length))),c.a.createElement("hr",null),b?c.a.createElement(k.a,null):c.a.createElement(c.a.Fragment,null,c.a.createElement(G.a,{setDataForm:ne,dataForm:te,redraw:J,statusCotization:L,handleDisplayFilter:function(e){3==e&&ne({date_desde:"",date_hasta:""}),$(e)},handleStadistics:function(){var a=Object.assign({},te);$(3),f.a.post(g.b+"invoice_stadistics",a).then((function(e){Q(Object(n.a)(Object(n.a)({},L),{},{statusesBonds:e.data.statusesBonds,statuses:e.data.statuses,bondsByMonth:e.data.bondsByMonth,invoiceByYear:e.data.invoiceByYear,totalByStatus:e.data.totalByStatus})),setTimeout((function(){q(!0),$(1)}),1e3)})).catch((function(a){$(1),e.tokenExpired(a)}))},displayFilter:Z,configGeneral:e.configGeneral}),c.a.createElement(u.a,null,c.a.createElement(d.a,{sm:12,md:12,lg:12,xs:12},c.a.createElement(m.a,{columns:w,data:z})))),c.a.createElement(S.a,{isOpenModalDetail:Y,handleModalDetail:ge,cotizationDetail:x,configGeneral:e.configGeneral}),c.a.createElement(N.a,{isShow:ue,onHide:me,cotization:ce,printInvoice:function(a){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_.b.info("Cargando documento, espere por favor"),O(!0),de(!1),f.a.get(g.b+"invoice_print/"+a.id+"/"+t+"/2").then((function(e){window.open(g.b+"documents/sale_note/files_pdf/"+e.data.name),O(!1),de(!0)})).catch((function(a){O(!1),e.tokenExpired(a)}))},goToBond:function(a){e.history.replace("/sale_note/sale_note_bond/"+a.id)},anulateInvoice:function(e){Object(C.confirmAlert)({customUI:function(a){var t=a.onClose;return c.a.createElement("div",{className:"custom-ui-edit"},c.a.createElement("h1",null,"\xbfEsta seguro?"),c.a.createElement("p",{className:"font-alert"},"\xbfDesea realmente anular este registro?"),e.bonds.length>0&&c.a.createElement("button",{className:"button-alert",onClick:function(){_e(e.id,!0),t()}},"Borrar pagos y anular"),c.a.createElement("button",{className:"button-alert",onClick:function(){_e(e.id,!1),t()}},"Anular"),c.a.createElement("button",{className:"button-alert",onClick:t},"No"))}})},seeDetailCotization:function(e){M(e),ge()},invoiceBySaleNote:function(a){e.history.replace("/invoice/create_invoice_by_sale_note/"+a.id)}}))}))}}]);