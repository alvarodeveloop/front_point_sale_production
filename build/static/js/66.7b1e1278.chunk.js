(this["webpackJsonpappwork-react-starter"]=this["webpackJsonpappwork-react-starter"]||[]).push([[66],{670:function(e,a,t){},791:function(e,a,t){"use strict";t.r(a);var r=t(16),n=t.n(r),c=t(89),s=t(34),l=t(47),o=t(18),i=t(15),u=t(1),m=t.n(u),d=t(31),p=t(608),b=t(46),g=t(598),f=t(197),E=t(301),h=t(28),_=t(113),j=t(88),v=t(9),O=t.n(v),x=t(8),k=t(10),y=(t(670),t(17)),w=t(77),S=function(e){var a=Object(u.useState)(!1),t=Object(i.a)(a,2),r=t[0],h=t[1],_=Object(u.useState)({name:"",email:"",rut:"",password:"",id_rol:"",password_repeat:""}),v=Object(i.a)(_,2),S=v[0],C=v[1],N=Object(u.useState)({name:"",address:"",is_open:!0,id:""}),q=Object(i.a)(N,2),R=(q[0],q[1],Object(u.useState)([])),P=Object(i.a)(R,2),z=P[0],D=P[1],I=Object(u.useState)([]),L=Object(i.a)(I,2),M=L[0],T=L[1],A=Object(u.useState)([]),F=Object(i.a)(A,2),J=F[0],U=F[1],V=Object(u.useState)(!1),B=Object(i.a)(V,2),G=B[0],H=B[1],K=Object(u.useState)(!1),Q=Object(i.a)(K,2),W=(Q[0],Q[1],Object(u.useState)(!1)),X=Object(i.a)(W,2),Y=X[0],Z=X[1],$=Object(u.useState)(1),ee=Object(i.a)($,2),ae=ee[0],te=ee[1],re=Object(u.useState)([]),ne=Object(i.a)(re,2),ce=(ne[0],ne[1],Object(u.useState)("")),se=Object(i.a)(ce,2),le=se[0],oe=se[1];Object(u.useEffect)((function(){!function(){var a=[O.a.get(k.b+"modules"),O.a.get(k.b+"roles")];e.match.params.id>0&&a.push(O.a.get(k.b+"user/"+e.match.params.id)),Promise.all(a).then((function(a){U(a[0].data),T(a[1].data),e.match.params.id&&(C({name:a[2].data.user.name,email:a[2].data.user.email,rut:a[2].data.user.rut,password:"",id_rol:a[2].data.user.id_rol,password_repeat:""}),3==a[2].data.user.id_rol||4==a[2].data.user.id_rol?D(a[2].data.modules.map((function(e){return e.id_menu}))):(a[2].data.user.id_rol>4||a[2].data.user.id_rol<=2)&&te(2),a[2].data.message&&oe(a[2].data.message),Z(!0)),h(!1)})).catch((function(a){h(!1),e.tokenExpired(a)}))}()}),[e.id_enterprise]);var ie=function(e){"id_rol"===e.target.name?(3==e.target.value||4==e.target.value||1==e.target.value?te(1):te(3),C(Object(o.a)(Object(o.a)({},S),{},Object(l.a)({},e.target.name,e.target.value)))):"rut"===e.target.name?C(Object(o.a)(Object(o.a)({},S),{},Object(l.a)({},e.target.name,Object(y.b)(e.target.value)))):C(Object(o.a)(Object(o.a)({},S),{},Object(l.a)({},e.target.name,e.target.value)))},ue=function(){var e=Object(s.a)(n.a.mark((function e(a,t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.persist(),!a.target.checked){e.next=6;break}return e.next=4,D([].concat(Object(c.a)(z),[t]));case 4:e.next=7;break;case 6:D(z.filter((function(e){return e!=a.target.value})));case 7:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}(),me=function(){e.history.replace("/user/list")},de=function(){var a=Object(s.a)(n.a.mark((function a(t){var r;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,O.a.get(k.b+"menu_user");case 2:r=a.sent,e.setMenu(r.data),t?setTimeout((function(){e.history.push("/user/list")}),1e3):e.history.push("/user/list");case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return m.a.createElement(p.a,null,r?m.a.createElement(w.a,null):m.a.createElement(b.a,{onSubmit:function(a){var t=a.currentTarget;if(a.preventDefault(),!1===t.checkValidity())return a.stopPropagation(),void H(!0);if(0===z.length&&(3==S.id_rol||4==S.id_rol))return a.stopPropagation(),H(!0),void x.b.error("Debe escoger al menos un m\xf3dulo para el usuario");var r=Object.assign({},S,{modules:z});if(h(!0),Y){if(r.password!==r.password_repeat)return x.b.error("Las contrase\xf1as no coinciden"),!1}else{if(!r.password)return x.b.error("Debe escribir una contrase\xf1a"),!1;if(r.password!==r.password_repeat)return x.b.error("Las contrase\xf1as no coinciden"),!1}r.id_rol>=4&&r.id_rol<=7&&(r.id_sucursal=localStorage.getItem("id_sucursal"));var n="";h(!0),Y?(n=r.id_rol>=3&&r.id_rol<=7?k.b+"user_by_branch_office/"+e.match.params.id:k.b+"user/"+e.match.params.id,O.a.put(n,r).then((function(e){x.b.success("Usuario Modificado"),de(!0),h(!1)})).catch((function(a){h(!1),e.tokenExpired(a)}))):(n=r.id_rol>=3&&r.id_rol<=7?k.b+"user_by_brach_office":k.b+"user",O.a.post(n,r).then((function(e){x.b.success("Usuario Registrado"),de(!1),h(!1)})).catch((function(a){h(!1),e.tokenExpired(a)})))},noValidate:!0,validated:G},m.a.createElement(g.a,null,m.a.createElement(f.a,{sm:ae>1?12:5,md:ae>1?12:5,lg:ae>1?12:5,xs:12,style:{borderRight:"1px solid rgb(237, 237, 237)"}},m.a.createElement("h4",{className:"text-center title_principal"},"Formulario de usuarios"),m.a.createElement("br",null),m.a.createElement(g.a,null,m.a.createElement(j.a,Object.assign({},e.inputName,{handleChange:ie,value:S.name})),m.a.createElement(j.a,Object.assign({},e.inputEmail,{handleChange:ie,value:S.email}))),m.a.createElement(g.a,null,m.a.createElement(j.a,Object.assign({},e.inputRut,{handleChange:ie,value:S.rut})),m.a.createElement(j.a,Object.assign({},e.inputPassword,{handleChange:ie,value:S.password}))),m.a.createElement(g.a,null,m.a.createElement(j.a,{type:"password",label:"Confirme Contrase\xf1a",name:"password_repeat",required:!1,messageErrors:[],cols:"col-md-6 col-lg-6 col-sm-6",value:S.password_repeat,handleChange:ie}),m.a.createElement(j.a,Object.assign({},e.inputSelect,{cols:"col-md-6 col-sm-6 col-lg-6",handleChange:ie,value:S.id_rol}),m.a.createElement("option",{value:""},"--Seleccione--"),Y?2==S.id_rol||9==S.id_rol?M.map((function(e,a){return m.a.createElement("option",{key:a,value:e.id},e.name_role)})):M.filter((function(e){return 2!==e.id&&9!==e.id})).map((function(e,a){return m.a.createElement("option",{key:a,value:e.id},e.name_role)})):M.filter((function(e){return 2!==e.id})).map((function(e,a){return m.a.createElement("option",{key:a,value:e.id},e.name_role)})))),m.a.createElement(g.a,{className:"justify-content-center"},1===ae?m.a.createElement(f.a,{sm:12,md:12,lg:12,xs:12,className:"text-center"},m.a.createElement(E.a,{size:"sm",type:"submit",variant:"danger",block:!0},"Enviar ",m.a.createElement(d.A,null)),"o",m.a.createElement(E.a,{size:"sm",onClick:me,type:"button",variant:"info",block:!0},"Ir al Listado")):m.a.createElement(f.a,{sm:6,md:6,lg:6,xs:12,className:"text-center"},m.a.createElement(E.a,{size:"sm",type:"submit",variant:"danger",block:!0},"Enviar ",m.a.createElement(d.A,null)),"o",m.a.createElement(E.a,{size:"sm",onClick:me,type:"button",variant:"info",block:!0},"Ir al Listado"))),m.a.createElement("br",null),le?m.a.createElement("p",{className:"alert alert-info text-center"},le):""),1==ae?m.a.createElement(f.a,{sm:7,md:7,lg:7,xs:12,className:"containerDivSeparated",style:{height:"450px"}},m.a.createElement("h4",{className:"text-center title_principal"},"M\xf3dulos"),m.a.createElement(g.a,null,J.map((function(e,a){return m.a.createElement(f.a,{sm:4,md:4,lg:4,xs:6,key:a},m.a.createElement(b.a.Group,null,m.a.createElement(b.a.Check,{type:"checkbox",custom:!0,id:e.name_item+e.id,label:e.name_item,value:e.id,checked:!!z.find((function(a){return a==e.id})),onChange:function(a){return ue(a,e.id)}})))}))),m.a.createElement(g.a,{className:"fixedBottom"},m.a.createElement(f.a,{sm:12,md:12,lg:12},m.a.createElement("p",{className:"text-center"},"Hacer click en el bot\xf3n enviar para guardar los cambios")),m.a.createElement(f.a,{sm:6,md:6,lg:6,xs:12},m.a.createElement(E.a,{size:"sm",variant:"secondary",block:!0,onClick:function(){var e=J.map((function(e){return e.id}));D(e)}},"Seleccionar Todos ",m.a.createElement(d.g,null))),m.a.createElement(f.a,{sm:6,md:6,lg:6,xs:12},m.a.createElement(E.a,{size:"sm",variant:"secondary",block:!0,onClick:function(){D([])}},"Deseleccionar Todos ",m.a.createElement(d.P,null))))):"")))};S.defaultProps={inputName:{type:"text",required:!0,name:"name",label:"Nombre Completo",messageErrors:["Requerido*"],cols:"col-sm-6 col-md-6 col-lg-6 col-xs-6"},inputEmail:{type:"email",required:!0,name:"email",label:"Email",messageErrors:["Requerido*, ","Formato tipo Email*"],cols:"col-sm-6 col-md-6 col-lg-6 col-xs-6"},inputRut:{type:"text",required:!0,name:"rut",label:"Documento Identidad",messageErrors:["Requerido*"],cols:"col-sm-6 col-md-6 col-lg-6 col-xs-6"},inputPassword:{type:"password",required:!1,name:"password",label:"Contrase\xf1a",messageErrors:["Requerido*"],cols:"col-sm-6 col-md-6 col-lg-6 col-xs-6"},inputSelect:{type:"select",required:!0,name:"id_rol",label:"Rol",messageErrors:["Requerido*"]}},a.default=Object(h.b)((function(e){return{id_enterprise:e.enterpriseSucursal.id_enterprise}}),{setMenu:_.c})(S)}}]);