{"version":3,"sources":["assets/img/utils/empty_logo.jpg","pages/ProfilePage.jsx"],"names":["module","exports","ProfilePage","props","useState","validated","setValidated","displayLoading","setDisplayLoading","email","name","phone","password","confirm_password","img_profile","file","dataForm","setDataForm","src","require","id","style","width","roundedCircle","imgComponent","setImgComponent","useEffect","fetchData","axios","get","API_URL","then","result","oldData","Object","assign","data","rut","catch","err","tokenExpired","onChange","e","target","formatRut","value","fluid","className","sm","md","lg","onSubmit","form","currentTarget","preventDefault","checkValidity","stopPropagation","console","log","toast","error","formData","FormData","keys","forEach","item","i","append","post","success","setTimeout","history","replace","noValidate","type","label","required","messageErrors","cols","handleChange","variant","block","onClick","document","getElementById","click","size","display","files","reader","FileReader","onload","event","readAsDataURL"],"mappings":"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","file":"static/js/60.4755e90d.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/empty_logo.258d3697.jpg\";","import React, {useState,useEffect} from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport {\r\n  Row,\r\n  Col,\r\n  Container,\r\n  Button,\r\n  Form,\r\n  Image\r\n} from 'react-bootstrap'\r\nimport {FaPlusCircle,FaImage} from 'react-icons/fa'\r\nimport {formatRut} from 'utils/functions'\r\nimport axios from 'axios'\r\nimport {API_URL} from 'utils/constants'\r\nimport {toast} from 'react-toastify'\r\nimport InputField from 'components/input/InputComponent'\r\nimport LoadingComponent from 'components/LoadingComponent'\r\n\r\n\r\nconst ProfilePage = (props) => {\r\n  const [validated, setValidated] = useState(false)\r\n  const [displayLoading, setDisplayLoading] = useState(true)\r\n  const [dataForm, setDataForm] = useState({\r\n    email: '',\r\n    name: '',\r\n    phone: '',\r\n    password: '',\r\n    confirm_password: '',\r\n    img_profile: '',\r\n    file: '',\r\n  })\r\n  const [ imgComponent, setImgComponent ] = useState(\r\n    <Image src={  require('../assets/img/utils/empty_logo.jpg') }\r\n      id=\"imagen_logo\" style={{ width: '70px' }} roundedCircle />\r\n  )\r\n\r\n  useEffect(() => {\r\n    fetchData()\r\n  },[])\r\n\r\n  const fetchData = () => {\r\n     axios.get(API_URL+'profile').then(result => {\r\n      setDataForm(oldData => {\r\n        return Object.assign({},oldData,{\r\n          email: result.data.email,\r\n          name: result.data.name,\r\n          phone: result.data.phone,\r\n          rut: result.data.rut,\r\n          img_profile: result.data.img_profile,\r\n        })\r\n      })\r\n\r\n      if(result.data.img_profile){\r\n        setImgComponent(\r\n          <Image src={API_URL+'images/user/'+result.data.img_profile}\r\n            id=\"imagen_logo\" style={{ width: '50%' }} roundedCircle />\r\n        )\r\n      }\r\n      setDisplayLoading(false)\r\n     }).catch(err => {\r\n      setDisplayLoading(false)\r\n      props.tokenExpired(err)\r\n     })\r\n  }\r\n\r\n  const onChange = e => {\r\n    setDataForm({...dataForm, [e.target.name] : e.target.name === \"rut\" ? formatRut(e.target.value) : e.target.value })\r\n  }\r\n\r\n  const onSubmit = e => {\r\n    const form = e.currentTarget;\r\n    e.preventDefault();\r\n    if (form.checkValidity() === false) {\r\n      e.stopPropagation();\r\n      setValidated(true);\r\n      return\r\n    }\r\n    if(dataForm.password !== dataForm.confirm_password){\r\n      console.log(dataForm.password,dataForm.confirm_password,'aqui');\r\n      toast.error('Las contraseñas no coinciden')\r\n      return false\r\n    }\r\n\r\n    let formData = new FormData()\r\n    Object.keys(dataForm).forEach((item, i) => {\r\n      if(item === \"file\"){\r\n        formData.append('logo_profile',dataForm[item])\r\n      }else{\r\n        formData.append(item,dataForm[item])\r\n      }\r\n    });\r\n    setDisplayLoading(true)\r\n    axios.post(API_URL+'profile',formData).then(result => {\r\n      toast.success('Datos modificados con éxito')\r\n      setTimeout(function () {\r\n        props.history.replace('/dashboard')\r\n      }, 1500);\r\n    }).catch(err => {\r\n      setDisplayLoading(false)\r\n      props.tokenExpired(err)\r\n    })\r\n  }\r\n\r\n  const displayFileField = () => {\r\n    document.getElementById('input_file').click()\r\n  }\r\n\r\n  const readImgProduct = e => {\r\n\r\n    let file = e.target.files[0];\r\n\r\n    let reader = new FileReader();\r\n    reader.onload = event => {\r\n      // The file's text will be printed here\r\n\r\n      setImgComponent(\r\n        <Image src={ event.target.result }\r\n          id=\"img_show\" style={{ width: '50%' }} roundedCircle />\r\n      )\r\n\r\n      setDataForm({...dataForm, file})\r\n    };\r\n\r\n    reader.readAsDataURL(file);\r\n  }\r\n\r\n  const goToDashboard = () => {\r\n    props.history.replace('/dashboard')\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {displayLoading ? (\r\n        <Container fluid={true}>\r\n          <LoadingComponent />\r\n        </Container>\r\n      ) : (\r\n        <Container fluid={true}>\r\n          <Row className=\"\">\r\n            <Col sm={6} md={6} lg={6}>\r\n              <h4 className=\"title_principal\">Perfil del Usuario</h4>\r\n            </Col>\r\n            <Col sm={6} md={6} lg={6} className=\"text-center\">\r\n              {imgComponent}\r\n            </Col>\r\n          </Row>\r\n          <hr/>\r\n          <Col sm={12} md={12} lg={12}>\r\n            <Form onSubmit={onSubmit} noValidate validated={validated}>\r\n              <Row>\r\n                <InputField\r\n                type='email'\r\n                label='Email'\r\n                name='email'\r\n                required={true}\r\n                messageErrors={[\r\n                'Requerido* ','Formato Email'\r\n                ]}\r\n                cols='col-md-4 col-lg-4 col-sm-4'\r\n                value={dataForm.email}\r\n                handleChange={onChange}\r\n                />\r\n                <InputField\r\n                  type='text'\r\n                  label='Rut'\r\n                  name='rut'\r\n                  required={true}\r\n                  messageErrors={[\r\n                  'Requerido*'\r\n                  ]}\r\n                  cols='col-md-4 col-lg-4 col-sm-4'\r\n                  value={dataForm.rut}\r\n                  handleChange={onChange}\r\n                />\r\n                <InputField\r\n                type='text'\r\n                label='Nombre completo'\r\n                name='name'\r\n                required={true}\r\n                messageErrors={[\r\n                'Requerido*'\r\n                ]}\r\n                cols='col-md-4 col-lg-4 col-sm-4'\r\n                value={dataForm.name}\r\n                handleChange={onChange}\r\n                />\r\n              </Row>\r\n              <Row>\r\n                <InputField\r\n                type='text'\r\n                label='Fono'\r\n                name='phone'\r\n                required={true}\r\n                messageErrors={[\r\n                'Requerido*'\r\n                ]}\r\n                cols='col-md-4 col-lg-4 col-sm-4'\r\n                value={dataForm.phone}\r\n                handleChange={onChange}\r\n                />\r\n              <InputField\r\n                type='password'\r\n                label='Contraseña'\r\n                name='password'\r\n                required={false}\r\n                messageErrors={[\r\n                'Requerido*'\r\n                ]}\r\n                cols='col-md-4 col-lg-4 col-sm-4'\r\n                value={dataForm.password}\r\n                handleChange={onChange}\r\n              />\r\n              <InputField\r\n                type='password'\r\n                label='Confirme Contraseña'\r\n                name='confirm_password'\r\n                required={false}\r\n                messageErrors={[\r\n                'Requerido*'\r\n                ]}\r\n                cols='col-md-4 col-lg-4 col-sm-4'\r\n                value={dataForm.confirm_password}\r\n                handleChange={onChange}\r\n              />\r\n              </Row>\r\n              <Row>\r\n                <Col sm={4} md={4} lg={4}>\r\n                  <Button variant=\"primary\" block={true} onClick={displayFileField} type=\"button\" size=\"sm\">Escoger imagen del perfil <FaImage /></Button>\r\n                  <input type=\"file\" style={{display : \"none\"}} id=\"input_file\" onChange={readImgProduct} />\r\n                </Col>\r\n              </Row>\r\n              <br/>\r\n              <Row className=\"justify-content-center\">\r\n                <Col sm={4} md={4} lg={4}>\r\n                  <Button variant=\"danger\" block={true} type=\"submit\" size=\"sm\">Guardar <FaPlusCircle /></Button>\r\n                </Col>\r\n                <Col sm={4} md={4} lg={4}>\r\n                  <Button variant=\"secondary\" block={true} type=\"button\" size=\"sm\" onClick={goToDashboard}>Ir al Dashboard</Button>\r\n                </Col>\r\n              </Row>\r\n            </Form>\r\n          </Col>\r\n        </Container>\r\n      )}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default ProfilePage\r\n"],"sourceRoot":""}